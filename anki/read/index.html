<!DOCTYPE html>
<html>
  <head>
    <title>暗記読み込み (Memory Load)</title>
  </head>
  <body>
    <div class="container">
      <h1>読み込み (Load)</h1>
      <div class="controls">
        <input type="file" id="inputJSON" accept="application/json" multiple />
        <input type="submit" id="submit" value="ファイル読み込み (Load Files)" />
      </div>
    </div>

    <script>
      document.getElementById("submit").addEventListener("click", function() {
        const fileInput = document.getElementById("inputJSON");
        const files = fileInput.files;
        logsDiv.innerHTML = ""; // Clear previous logs

        if (files.length === 0) {
          logsDiv.innerHTML = '<div class="log-entry error">ファイルが選択されていません。 (No files selected.)</div>';
          return;
        }

        let completed = 0;
        let jsonContents = [];

        for (const file of files) {
          const reader = new FileReader();

          reader.onload = (event) => {
            try {
              const content = event.target.result;
              const jsonObject = JSON.parse(content);
              jsonContents.push(jsonObject);
            } catch (error) {
              console.error("❌ ファイル "${file.name}" の解析に失敗しました: ${error.message}")
            } finally {
              completed++;
              if (completed === files.length) 
                console.log("All JSON contents:", jsonContents);
              }
            }
          };

          reader.onerror = () => {
            logsDiv.innerHTML += `<div class="log-entry error">❌ ファイル "${file.name}" の読み込み中にエラーが発生しました。 (An error occurred while reading file "${file.name}".)</div>`;
            completed++;
          };

          reader.readAsText(file)
        }
        jsonContent.sort(() => Math.random() - 0.5);
        
      });
    </script>
  </body>
</html>
