<!DOCTYPE html>
<html>
  <head>
    <title>暗記</title>
  </head>
  <body>
    <form id="foom">
      <p>問題:</p><input id="question" type="text" required>
      <div id="answers-container">
        <p>回答1:</p><input type="text" class="kaitou" required>
        <p>回答2:</p><input type="text" class="kaitou" required>
      </div>
      <button type="button" id="addkaitou">回答を追加</button>
    </form>
    <button id="download">
    <a src="/" id="link">ダウンロード</a>
    <script>
      const form = document.getElementById("foom");
      const addAnswerBtn = document.getElementById("addkaitou");
      const answersContainer = document.getElementById("answers-container");
      const download = document.getElementById("download");
      
      let answerCount = 2; // 既存の回答数からカウントを開始します

      download.addEventListener("click", function() {
        let queee = document.querySelectorAll(".kaitou");
        let data_list = [];
        queee.forEach(input => {
          data_list.append(input.value); // 各input要素の入力内容を表示
        });
        let mondai = document.getElementById("question").value;
        let data = {
          "question": mondai,
          "answer": data_list
        };
        const blob = new Blob([JSON.stringify(data, null, '  ')], {type: 'application\/json'});
        const url = URL.createObjectURL(blob);
        const download = document.getElementById("download");
        download.src = url;
      })
      
      addAnswerBtn.addEventListener("click", function() {
        answerCount++;
        const newAnswerContainer = document.createElement("div");
        newAnswerContainer.innerHTML = `
          <p>回答${answerCount}:</p>
          <input type="text" class="kaitou" required>
          <button type="button" class="kesukaitou">回答を削除</button>
        `;
        answersContainer.appendChild(newAnswerContainer);
      });

      // イベント委譲により、親要素で削除イベントを処理します
      answersContainer.addEventListener("click", function(event) {
        if (event.target.classList.contains("kesukaitou")) {
          event.target.parentNode.remove();
        }
      });
    </script>
  </body>
</html>
