<!DOCTYPE html>
<html>
  <head>
    <title>F4F tool</title>
  </head>
  <body>
    <div class="content">
      <label for="username">ユーザー:</label><input type=text id="username" />
      <label for="password">パスワード:</label><input type=password id="passeord" />
      <input type=submit id="submit" value="送信" />
    </div>
    <script>
      function submit2() {
        const form = document.querySelector('form');
        const data = new FormData(form);
        for (const entry of data) {
          const selected = int(entry[1]);
        }
        fetch(`https://api.zeipara.f5.si/F4F?page=${selected}&username=${username}&password=${password}`)
        .then(response => {
          return response.json();
        })
        .then(data => {
          alert(data.result);
        });
      }
      
      function submit() {
        username = document.getElementById('username').value;
        password = document.getElementById('password').value;
        fetch(`https://api.zeipara.f5.si/F4F/login/?username=${username}&password=${password}`)
        .then(response => {
          return response.json();
        })
        .then(data => {
          if (data.loginsuccess == false) {
            alert("ログインに失敗しました");
          } else {
            alert("ログインに成功しました");
            const page = data.page;
            let page_html = "<form>";
            for (const i in [...Array(page).keys()]) {
              if (i=
              page_html = page_html + `\n<input type=radio name=\"page\" id=\"page${String(i+1)}\" value=\"${String(i+1)}\" /><label for=\"page${String(i+1)}\">${String(i+1)}ページ</label>`;
            }
            page_html = page_html + '<input type=submit id=submit2 /></form>';
            document.querySelector('.content').innerHTML = page_html;
            document.getElementById('submit2').addEventListener('click', submit2);
          }
        });
      }
        
      let password;
      let username;
      document.getElementById('submit').addEventListener("click", submit)
    </script>
  </body>
</html>
